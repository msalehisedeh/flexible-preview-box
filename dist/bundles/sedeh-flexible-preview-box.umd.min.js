!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@sedeh/into-pipes")):"function"==typeof define&&define.amd?define("@sedeh/flexible-preview-box",["exports","@angular/core","@angular/common","@sedeh/into-pipes"],t):t(((e=e||self).sedeh=e.sedeh||{},e.sedeh["flexible-preview-box"]={}),e.ng.core,e.ng.common,e["into-pipes"])}(this,(function(e,t,i,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function n(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a}var r=function(){function e(){this.aboveData=[],this.belowData=[],this.onselect=new t.EventEmitter,this.onaction=new t.EventEmitter,this.enableMobileMagnification=!0,this.magnificationFactor=2}return e.prototype.ngOnInit=function(){var e=this;this.metadata&&this.metadata.map((function(t){"above"===t.position?e.aboveData.push(t):"below"===t.position&&e.belowData.push(t)})),this.magnificationFactor<2&&(this.magnificationFactor=2)},e.prototype.itemValue=function(e,t){var i=e;return t.map((function(e){i&&(i=i[e])})),null==i||"null"===i?"":String(i)},e.prototype.rowContent=function(e){if(e.rawContent)return e.rawContent(this.item);var t=this.itemValue(this.item,e.key.split("."));return void 0!==t&&null!=t?t:""},e.prototype.touchstart=function(e){if(this.enableMobileMagnification&&this.largeImage&&this.effects.zoomOnHover){var t=e.target.children[0];if(t){var i=t.getBoundingClientRect();this.largeImage.nativeElement.style.width=this.magnificationFactor*i.width+"px",this.largeImage.nativeElement.style.height=this.magnificationFactor*i.height+"px",t.style.visibility="hidden"}this.onaction.emit({action:"viewport",type:e.type,item:this.item})}},e.prototype.touchmove=function(e){if(this.enableMobileMagnification&&this.largeImage&&this.effects.zoomOnHover){e.preventDefault(),e.stopPropagation();var t=e.target.children[0],i=t.parentNode.getBoundingClientRect(),o=t.getBoundingClientRect(),n=e.touches[0].clientX-i.x,r=e.touches[0].clientY-i.y,a=(this.effects.width-o.width)*(this.magnificationFactor/2),s=(this.effects.height-o.height)*(this.magnificationFactor/2),l=r*(this.magnificationFactor-1),c=n*(this.magnificationFactor-1);this.largeImage.nativeElement.style.top=-l+s+"px",this.largeImage.nativeElement.style.left=-c+a+"px",this.largeImage.nativeElement.style.opacity=1,this.onaction.emit({action:"viewport",type:e.type,position:{Y:c,X:l},item:this.item})}},e.prototype.touchend=function(e){this.enableMobileMagnification&&this.largeImage&&(e.target.children[0].style.visibility="visible",this.largeImage.nativeElement.style.opacity=0,this.largeImage.nativeElement.style.top="-10000px",this.largeImage.nativeElement.style.left="-10000px",this.onaction.emit({action:"viewport",type:e.type,item:this.item}))},e.prototype.hoverOver=function(e){if(this.largeImage&&this.effects.zoomOnHover){var t=e.target.children[0];if(t){var i=t.getBoundingClientRect();this.largeImage.nativeElement.style.width=this.magnificationFactor*i.width+"px",this.largeImage.nativeElement.style.height=this.magnificationFactor*i.height+"px",t.style.visibility="hidden"}this.onaction.emit({action:"viewport",type:e.type,item:this.item})}},e.prototype.hoverOut=function(e){this.largeImage&&(e.target.children[0].style.visibility="visible",this.largeImage.nativeElement.style.opacity=0,this.largeImage.nativeElement.style.top="-10000px",this.largeImage.nativeElement.style.left="-10000px",this.onaction.emit({action:"viewport",type:e.type,item:this.item}))},e.prototype.hoverViewPort=function(e){if(this.largeImage&&this.effects.zoomOnHover){var t=e.target.children[0].getBoundingClientRect(),i=(this.effects.width-t.width)*(this.magnificationFactor/2),o=(this.effects.height-t.height)*(this.magnificationFactor/2),n=e.layerY*(this.magnificationFactor-1),r=e.layerX*(this.magnificationFactor-1);this.largeImage.nativeElement.style.top=-n+o+"px",this.largeImage.nativeElement.style.left=-r+i+"px",this.largeImage.nativeElement.style.opacity=1,this.onaction.emit({action:"viewport",type:e.type,position:{Y:r,X:n},item:this.item})}},e.prototype.updateControls=function(e){this.video&&this.video.nativeElement.play()},e.prototype.resetControls=function(e){this.video&&this.isPlaying(this.video.nativeElement)&&this.video.nativeElement.pause()},e.prototype.isPlaying=function(e){return!!(e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2)},e.prototype.keyup=function(e){13===e.which&&e.target.click()},e.prototype.selectItem=function(e){this.onselect.emit({action:"redirect",type:"select",item:this.item})},e.prototype.videoEvent=function(e){this.onaction.emit({action:"video",type:e.type,item:{autoplay:e.target.autoplay,controls:e.target.controls,duration:e.target.duration,ended:e.target.ended,error:e.target.error,paused:e.target.paused,muted:e.target.muted,currentTime:e.target.currentTime,volume:e.target.volume}})},e.prototype.onComponentChange=function(e){e.action&&e.type&&e.item?this.onaction.emit(e):this.onaction.emit({action:e.name,type:e.item,item:this.item})},e.prototype.defaultAction=function(){},n([t.ViewChild("largeImage",{static:!1})],e.prototype,"largeImage",void 0),n([t.ViewChild("video",{static:!1})],e.prototype,"video",void 0),n([t.Output()],e.prototype,"onselect",void 0),n([t.Output()],e.prototype,"onaction",void 0),n([t.Input()],e.prototype,"item",void 0),n([t.Input()],e.prototype,"viewport",void 0),n([t.Input()],e.prototype,"metadata",void 0),n([t.Input()],e.prototype,"effects",void 0),n([t.Input()],e.prototype,"enableMobileMagnification",void 0),n([t.Input()],e.prototype,"magnificationFactor",void 0),e=n([t.Component({selector:"flexible-preview-box",template:'<div class="above-viewport" \r\n    [style.max-width]="effects.width ? (effects.width + \'px\') : \'auto\'">\r\n    <div *ngFor="let row of aboveData; let i = index" \r\n        class="box-row"\r\n        [style.margin-top]="row.spacing ? (row.spacing + \'px\') : \'0\'"\r\n        [class.left]="row.side === \'left\'"\r\n        [class.right]="row.side === \'right\'"\r\n        [class.center]="row.side === \'center\'"\r\n        [class.link]="row.action !== undefined"\r\n        [class.emphasize]="row.emphasize"\r\n        [class.side-by-side]="row.sidebyside"\r\n        [attr.role]="row.action ? \'link\' : \'\'"\r\n        [tabIndex]="row.action ? 0 : -1"\r\n        (click)="row.action ? row.action(row) : defaultAction()">\r\n        <span class="label" \r\n            [class.off-screen]="row.hidelabel" \r\n            [textContent]="row.value"></span>\r\n        <span class="value" \r\n            [intoName]="row.value"\r\n            [intoId]="row.key + \'-\' + i"\r\n            [into]="row.format"\r\n            [intoData]="item"\r\n            [rawContent]="rowContent(row)"\r\n            [tabIndex]="row.rawContent ? 0 : -1"\r\n            [onComponentChange]="onComponentChange.bind(this)"></span>\r\n    </div>\r\n    <div class="clearblock"></div>\r\n</div>\r\n<div \r\n    class="viewport" \r\n    tabindex="0"\r\n    [title]="item.name"\r\n    [style.width]="effects.width ? (effects.width + \'px\') : null" \r\n    [style.height]="effects.height ? (effects.height + \'px\') : null" \r\n    (focus)="updateControls($event)"\r\n    (blur)="resetControls($event)"\r\n    (keyup)="keyup($event)"\r\n    (click)="selectItem($event)"\r\n    (touchstart)="touchstart($event)"\r\n    (touchmove)="touchmove($event)"\r\n    (touchend)="touchend($event)"\r\n    (mouseout)="hoverOut($event)"\r\n    (mouseover)="hoverOver($event)"\r\n    (mousemove)="hoverViewPort($event)">\r\n    <img  class="content" \r\n            [src]="viewport.src.small" \r\n            *ngIf="viewport.type === \'image\'" />\r\n    <img  class="hover" #largeImage aria-hidden="true"\r\n            [src]="viewport.src.large" \r\n            *ngIf="effects.zoomOnHover" />\r\n    <video  \r\n        class="content" #video\r\n        [style.width]="effects.width ? (effects.width + \'px\') : null" \r\n        [style.height]="effects.height ? (effects.height + \'px\') : null" \r\n        [attr.poster]="viewport.poster ? viewport.poster : null"\r\n        (mouseenter)="updateControls($event)"\r\n        (mouseleave)="resetControls($event)"\r\n        (play)="videoEvent($event)"\r\n        (pause)="videoEvent($event)"\r\n        (ended)="videoEvent($event)"\r\n        (seeked)="videoEvent($event)"\r\n        (error)="videoEvent($event)"\r\n        (fullscreenchange)="videoEvent($event)"\r\n        *ngIf="viewport.type === \'video\'">\r\n        <source [src]="viewport.src.mp4" type="video/mp4">\r\n        <source [src]="viewport.src.webm" type="video/webm">\r\n        <source [src]="viewport.src.egg" type="video/ogg">\r\n    </video>\r\n</div>\r\n<div class="below-viewport" [style.max-width]="effects.width ? (effects.width + \'px\') : \'auto\'">\r\n    <div *ngFor="let row of belowData; let i = index" \r\n        class="box-row"\r\n        [style.margin-top]="row.spacing ? (row.spacing + \'px\') : \'0\'"\r\n        [class.left]="row.side === \'left\'"\r\n        [class.right]="row.side === \'right\'"\r\n        [class.center]="row.side === \'center\'"\r\n        [class.link]="row.action !== undefined"\r\n        [class.emphasize]="row.emphasize"\r\n        [class.side-by-side]="row.sidebyside"\r\n        [attr.role]="row.action ? \'link\' : \'\'"\r\n        [tabIndex]="row.action ? 0 : -1"\r\n        (click)="row.action ? row.action(row) : defaultAction()">\r\n        <span class="label" [class.off-screen]="row.hidelabel" [textContent]="row.value"></span>\r\n        <span class="value" \r\n            [intoName]="row.value"\r\n            [class.full-width]="row.hidelabel"\r\n            [intoId]="row.key + \'-\' + i"\r\n            [into]="row.format"\r\n            [intoData]="item"\r\n            [rawContent]="rowContent(row)"\r\n            [onComponentChange]="onComponentChange.bind(this)"></span>\r\n    </div>\r\n    <div class="clearblock"></div>\r\n</div>',styles:[":host{background-color:#fff;border:1px solid #ced4da;box-sizing:border-box;display:table;min-height:50px;padding:0;border-radius:5px;margin:5px}:host:focus{border-color:#0ba}:host:hover{border-color:purple;box-shadow:1px 1px 11px purple}:host ::ng-deep .rating{color:red}:host ::ng-deep share-component .off-screen{display:block;float:left;height:0;overflow:hidden;text-indent:-99999px;width:0}:host .off-screen{display:block;float:left;height:0;overflow:hidden;text-indent:-99999px;width:0}:host .box-row .label{float:left;font-weight:700;margin-right:5px}:host .box-row .value{float:left}:host .box-row .value.full-width{display:block;width:100%}:host .box-row.link{cursor:pointer}:host .box-row.left{text-align:left}:host .box-row.right .label{font-weight:700;flex:1;text-align:right}:host .box-row.center{width:inherit;display:table;margin:auto}:host .box-row.emphasize{font-weight:700;font-size:1.8rem}:host .box-row.side-by-side{max-width:250px;display:table;float:right;margin:0 5px}:host .above-viewport{padding:5px;box-sizing:border-box}:host .viewport{border-color:purple;box-sizing:border-box;border-top:1px solid #bcd;border-bottom:1px solid #bcd;min-height:100px;overflow:hidden;position:relative;margin:0 auto;box-sizing:border-box;cursor:pointer}:host .viewport img.content{margin:auto;display:table;pointer-events:none}:host .viewport video.content{margin:auto;display:table}:host .viewport .hover{position:absolute;background-color:#fff;top:-10000px;left:-10000px;opacity:0;pointer-events:none}:host .viewport:hover{border-color:purple}:host .below-viewport{padding:5px;box-sizing:border-box}@media screen and (max-width:600px){:host{width:100%}:host .above-viewport,:host .below-viewport,:host .viewport{width:100%!important;max-width:100%!important}}.clearblock{clear:both;display:block;width:100%;height:0;padding:0;margin:0}"]})],e)}(),a=function(){function e(){}return e=n([t.NgModule({imports:[i.CommonModule,o.IntoPipeModule],declarations:[r],exports:[r],entryComponents:[],schemas:[t.CUSTOM_ELEMENTS_SCHEMA]})],e)}();e.FlexiblePreviewBoxComponent=r,e.FlexiblePreviewBoxModule=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sedeh-flexible-preview-box.umd.min.js.map